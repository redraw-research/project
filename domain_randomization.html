<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="description"
          content="ReDRAW: Adapting World Models with Latent-State Dynamics Residuals">
    <meta name="keywords" content="ReDRAW, DRAW, World Models">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ReDRAW: Adapting World Models with Latent-State Dynamics Residuals</title>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <!--   <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script> -->
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'G-PYVRSFMDRL');
    </script>

    <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
          rel="stylesheet">

    <link rel="stylesheet" href="./static/css/bulma.min.css">
    <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
    <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
    <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="./static/css/index.css">
    <!--   <link rel="icon" href="./static/images/favicon.svg"> -->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script defer src="./static/js/fontawesome.all.min.js"></script>
    <script src="./static/js/bulma-carousel.min.js"></script>
    <script src="./static/js/bulma-slider.min.js"></script>
    <script src="./static/js/index.js"></script>
</head>
<body>
<section class="hero">
    <div class="hero-body">
        <div class="container is-max-desktop">
            <div class="columns is-centered">
                <div class="column has-text-centered">
                    <h1 class="title is-1 publication-title">Adapting World Models<br>with Latent-State Dynamics Residuals</h1>
                    <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a>Anonymous</a></span>
                        <!--             <span class="author-block">
                                      <a href="https://keunhong.com">Keunhong Park</a><sup>1</sup>,</span>
                                    <span class="author-block">
                                      <a href="https://utkarshsinha.com">Utkarsh Sinha</a><sup>2</sup>,</span>
                                    <span class="author-block">
                                      <a href="https://jonbarron.info">Jonathan T. Barron</a><sup>2</sup>,
                                    </span>
                                    <span class="author-block">
                                      <a href="http://sofienbouaziz.com">Sofien Bouaziz</a><sup>2</sup>,
                                    </span>
                                    <span class="author-block">
                                      <a href="https://www.danbgoldman.com">Dan B Goldman</a><sup>2</sup>,
                                    </span>
                                    <span class="author-block">
                                      <a href="https://homes.cs.washington.edu/~seitz/">Steven M. Seitz</a><sup>1,2</sup>,
                                    </span>
                                    <span class="author-block">
                                      <a href="http://www.ricardomartinbrualla.com">Ricardo Martin-Brualla</a><sup>2</sup>
                                    </span> -->
                    </div>

                    <!--           <div class="is-size-5 publication-authors">
                                <span class="author-block"><sup>1</sup>University of Washington,</span>
                                <span class="author-block"><sup>2</sup>Google Research</span>
                              </div> -->

                    <div class="column has-text-centered">
                        <div class="publication-links">
                            <!-- PDF Link. -->
                            <!--              <span class="link-block">-->
                            <!--                <a href="https://redraw-research.github.io/project/"-->
                            <!--                   class="external-link button is-normal is-rounded is-dark">-->
                            <!--                  <span class="icon">-->
                            <!--                      <i class="fas fa-file-pdf"></i>-->
                            <!--                  </span>-->
                            <!--                  <span>Paper</span>-->
                            <!--                </a>-->
                            <!--              </span>-->
                            <!--               <span class="link-block">
                                            <a href="https://arxiv.org/abs/2011.12948"
                                               class="external-link button is-normal is-rounded is-dark">
                                              <span class="icon">
                                                  <i class="ai ai-arxiv"></i>
                                              </span>
                                              <span>arXiv</span>
                                            </a>
                                          </span> -->
                            <!-- Video Link. -->
                            <!--              <span class="link-block">-->
                            <!--                <a href="#video-section"-->
                            <!--                   class="external-link button is-normal is-rounded is-dark">-->
                            <!--                  <span class="icon">-->
                            <!--                      <i class="fab fa-youtube"></i>-->
                            <!--                  </span>-->
                            <!--                  <span>Video</span>-->
                            <!--                </a>-->
                            <!--              </span>-->
                            <!-- Code Link. -->
                            <!--              <span class="link-block">-->
                            <!--                <a href="https://redraw-research.github.io/project/"-->
                            <!--                   class="external-link button is-normal is-rounded is-dark">-->
                            <!--                  <span class="icon">-->
                            <!--                      <i class="fab fa-github"></i>-->
                            <!--                  </span>-->
                            <!--                  <span>Code</span>-->
                            <!--                  </a>-->
                            <!--              </span>-->
                            <!-- Dataset Link. -->
                            <!--               <span class="link-block">
                                            <a href="https://github.com/google/nerfies/releases/tag/0.1"
                                               class="external-link button is-normal is-rounded is-dark">
                                              <span class="icon">
                                                  <i class="far fa-images"></i>
                                              </span>
                                              <span>Data</span>
                                              </a> -->
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Abstract -->
<section class="section">
    <div class="container is-max-desktop">
        <!-- Abstract. -->
        <div class="columns is-centered has-text-centered">
            <div class="column">
                <h2 class="title is-3">Comparison with Dynamics Domain Randomization</h2>
                <div class="content has-text-left">
<!--                    <p style="font-size: 125%">-->
<!--                        Simulation-to-reality reinforcement learning (RL) faces the critical challenge of reconciling discrepancies between simulated and real-world dynamics, which can severely degrade agent performance. A promising approach involves learning corrections to simulator forward dynamics represented as a residual error function, however this operation is impractical with high-dimensional states such as images. To overcome this, we propose ReDRAW, a latent-state autoregressive world model pretrained in simulation and calibrated to target environments through residual corrections of latent-state dynamics rather than of explicit observed states. Using this adapted world model, ReDRAW enables RL agents to be optimized with imagined rollouts under corrected dynamics and then deployed in the real world. In multiple vision-based MuJoCo domains and a physical robot visual lane-following task, ReDRAW effectively models changes to dynamics and avoids overfitting in low data regimes where traditional transfer methods fail.-->
<!--                    </p>-->
                    <p>
                    We conduct an additional comparison in the Duckiebots domain in which we train DRAW and DreamerV3 with dynamics domain randomization. After pretraining in simulation with dynamics domain randomization, we zero-shot transfer to the target real environments. To represent both the possible range of real robot speeds and the per-step variations in speed present during real-world execution, we randomly scale the simulator's forward and yaw velocity coefficients by a random value each timestep sampled from a Gaussian distribution, N(1, 0.11).
                    </p>
                    <p>
                    The effective use of dynamics randomization relies on additional privileged conditions that ReDRAW does not require. Domain randomization requires a simulator with configurable physics parameters that can represent a distribution of training conditions useful for generalization to the real world. Furthermore, successful use of domain randomization requires added domain knowledge to correctly anticipate which distribution of training conditions will sufficiently account for the types of the dynamics errors the simulator is likely to make. Unlike domain randomization, ReDRAW does not require configurable simulator dynamics, nor does ReDRAW require an accurate understanding of the simulator's inaccuracies.
                    </p><p>
                    In Table 1 below, we compare the performance of DRAW and DreamerV3 Dyn DR (Dynamics Domain Randomization) against other methods in the unmodified real and actions-reversed real environments. The unmodified real environment represents a scenario in which the dynamics randomization scheme is well-motivated by potential simulator errors. In contrast, the actions-reversed real environment represents a scenario in which a critical disparity between simulation and reality was not anticipated or captured during randomized simulator training.
                    </p>
                </div>
            </div>
        </div>

        <div class="columns is-centered has-text-centered">
            <div class="column has-text-left is-7  is-centered">
                <img src="static/images/domain_randomization_table.png" alt="">
                <p>Table 1: Mean and SEM performance on the real Duckiebots lane-following task aggregated over 5 evaluation episodes each for 4 training seeds <b>(1 seed currently for Dynamics Domain Randomization)</b>. Agents are given 300 steps to complete a lap from a fixed starting position. <i>Center Offset</i> denotes distance from the lane center. Absence of a <i>Lap Tim</i>e indicates all runs either failing to complete a lap or terminating early by driving off the track.</p>
            </div>
        </div>

        <div class="columns is-centered has-text-centered">
            <div class="column">
                <div class="content has-text-left">
                    <p>
                        In the unmodified real environment, DRAW Dyn DR achieves low rewards by taking wide turns that cut corners and veer far from the lane center. Because driving off the track results in a large penalty, this behavior can be explained as taking conservative actions. The DRAW DYN agent avoids taking otherwise optimal sharp and late turns, likely because this normally optimal behavior can have a dangerous outcome in the randomized simulation given unknown forward and yaw speed coefficients.
                    </p>
                    <p>
                        Dreamer Dyn DR still hallucinates in the unmodified real environment despite learning to drive successfully in simulation. This is likely because the dynamics-randomized simulation still fails to sufficiently capture the distribution of state and action sequences present during real execution, causing out-of-distribution GRU states h.
                    </p>
                    <p>
                        In the actions-reversed real environment, both DRAW and Dreamer Dyn DR fail to drive because the reversed actions represent an unexpected disparity between simulation and real that was not represented during training.
                    </p>
                    <p>
                        In both of these real environments, despite not having access to configurable simulator physics, ReDRAW is able to use a small amount of real transition data to calibrate its world model and drive with a near-optimal policy.
                    </p>
                </div>
            </div>
        </div>

    </div>
</section>

<section class="section" id="video-section">
    <div class="container is-max-widescreen">
        <div class="rows">
            <div class="rows is-full-width">






                <div class="row is-full-width">
                    <h2 class="title is-3"><span
                            class="dvima">Qualitative Results</span></h2>
                    <h3 class="title is-5">Transferring from Simulation to Real</h3>
                    <video poster="" autoplay controls muted loop height="100%" style="border-radius: 5px;">
<!--                        &lt;!&ndash; AV1 &ndash;&gt;-->
<!--                        <source src="static/videos/duckiebots_sim_to_real_medium_av1.mp4"-->
<!--                                type="video/mp4; codecs=av01">-->
                        <!-- H.264 -->
                        <source src="static/videos/duckiebots_sim_to_real_dr_medium_h264.mp4"
                                type="video/mp4; codecs=avc1.4D401E">
                        <!-- H.265 (HEVC) -->
                        <source src="static/videos/duckiebots_sim_to_real_dr_medium_h265.mp4"
                                type="video/mp4; codecs=hev1">
                        Your browser does not support the video tag.
                    </video>
<!--                    <p style="font-size: 125%">In the real environment, ReDRAW achieves high average dense rewards by training an agent with corrected world-model dynamics and staying close to the lane center. Due to mismatched world-model dynamics, zero-shot DRAW incurs low rewards by veering far from the lane center. The ReDRAW dynamics residual avoids overfitting while traditional world-model fine-tuning fails in this low-data regime.</p>-->

                    <br>
                    <br>
                    <br>


                    <h3 class="title is-5">Transferring from Simulation to Real with Reversed Actions</h3>
                    <video poster="" autoplay controls muted loop height="100%" style="border-radius: 5px;">
<!--                        &lt;!&ndash; AV1 &ndash;&gt;-->
<!--                        <source src="static/videos/duckiebots_sim_to_real_actions_reversed_medium_av1.mp4"-->
<!--                                type="video/mp4; codecs=av01">-->
                        <!-- H.264 -->
                        <source src="static/videos/duckiebots_sim_to_real_dr_reverse_medium_h264.mp4"
                                type="video/mp4; codecs=avc1.4D401E">
                        <!-- H.265 (HEVC) -->
                        <source src="static/videos/duckiebots_sim_to_real_dr_reverse_medium_h265.mp4"
                                type="video/mp4; codecs=hev1">
                        Your browser does not support the video tag.
                    </video>
<!--                    <p style="font-size: 125%">In a more extreme task, we transfer from simulation to a version of the real environment where actions are reversed. ReDRAW is the only method that successfully adapts and completes laps on the real robot. ReDRAW can be effectively used to adapt mismatched simulation dynamics to reality using a limited offline real dataset without rewards, and ReDRAW can also be combined with visual adaptation methods in order to do so.</p>-->

                    <br>
                    <br>
                    <br>

                </div>
            </div>

        </div>
    </div>
</section>

<footer class="footer">
    <div class="container">
        <div class="content has-text-centered">
            <br />
            <p> Website template borrowed from <a href="https://nerfies.github.io">Nerfies</a>, <a href="https://eureka-research.github.io">Eureka</a>, and <a href="https://vimalabs.github.io/">VIMA</a>.</p>
        </div>
    </div>
</footer>

</body>
</html>
